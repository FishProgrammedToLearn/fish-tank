<?phpnamespace Home\Controller;use Think\Controller;class LoginController extends Controller{		//默认方法,判断where字符串决定跳转位置	public function index()	{		switch($_GET['where'])		{			case '':				$this->display('Login');			break;						case 'gr':				$this->display('register');			break;		}	}		//ajax注册判断	public function AjaxEnroll()	{		$m = D('Users');				if($m->create())		{			echo "<i class='glyphicon glyphicon-ok'></i>";		}else{			echo $m->getError();		}		}		//注册数据库插入判断	public function enroll()	{		$m = D('Users');		$m->create();		$res = $m->add();		if($res){			$data['username'] = $_POST['username'];			$mm = M('user_details');			$mm->add($data);			$this->success('注册成功', 'index');		}else{			$this->error('注册失败');		}	}		//登录判断	public function enter()	{		$m = M('users');		$res = $m->where("username='{$_POST['username']}'")->find();		if($res)		{			if($res['password'] == md5($_POST['password']))			{				if($res['switch'] == 1)				{					session('username',$res['username']);					session('status',$res['status']);					session('nickname',$res['nickname']);					if(session('nickname'))					{						$n = M('user_details');						$res1 = $n->where("username = '{$res['username']}'")->field('picture')->find();						session('picture',$res1['picture']);						$inform = M('inform');						$info = $inform->where("othername = '{$_SESSION['nickname']}'")->select();						$num = count($info) - $res['news'];						session('news',$num);						$this->success('登录成功', '/Home/HomePage/index',1);					}else{						$this->success('登录成功,请设置个人资料', '/Home/MyCenter/add',1);					}										}else{					$this->error('当前账号已被禁用');				}			}else				$this->error('账号或密码错误,请重新输入');		}else{			$this->error('账号或密码错误,请重新输入');		}	}}?>